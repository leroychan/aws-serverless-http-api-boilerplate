const { metricScope, Unit } = require('aws-embedded-metrics');

const applicationName = process.env.APPLICATION_NAME;

const publishMetricLatency = metricScope((metrics) => async (service, type, value) => {
  metrics.setNamespace(applicationName);
  metrics.putDimensions({ Service: service });
  metrics.putMetric(type, value, Unit.Milliseconds);
});

const publishMetricCount = metricScope((metrics) => async (service, type, value) => {
  metrics.setNamespace(applicationName);
  metrics.putDimensions({ Service: service });
  metrics.putMetric(type, value, Unit.Count);
});

module.exports = {
  publishMetricLatency,
  publishMetricCount,
};
